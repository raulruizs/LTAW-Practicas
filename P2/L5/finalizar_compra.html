<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Finalizar Compra</title>
    <link rel="stylesheet" href="finalizar.css">
</head>
<body>
    <header>
        <h1>âœ… Finalizar Compra</h1> 
    </header>

    <div id="carritoResumen"></div>

    <form method="GET" action="http://localhost:8001/finalizar-compra">
        <label for="direccion">DirecciÃ³n de envÃ­o:</label>
        <input type="text" name="direccion" id="direccion" required><br><br>

        <label for="tarjeta">NÃºmero de tarjeta:</label>
        <input type="text" name="tarjeta" id="tarjeta" required><br><br>

        <input type="submit" value="Confirmar Pedido">
    </form>

    <div class="mensaje-exito" id="mensajeExito" style="display: none;">
        âœ… Compra realizada con Ã©xito. Â¡Gracias por tu pedido!
    </div>
    
    <script>
        function leerCookie(nombre) {
            const cookies = document.cookie.split(';');
            for (let c of cookies) {
                const [key, val] = c.trim().split('=');
                if (key === nombre) return decodeURIComponent(val);
            }
            return null;
        }
    
        const carritoCookie = leerCookie("carrito");
        const carrito = carritoCookie ? JSON.parse(carritoCookie) : [];
    
        const contenedor = document.getElementById("carritoResumen");
    
        if (carrito.length === 0) {
            contenedor.innerHTML = "<p>ðŸ›’ Tu carrito estÃ¡ vacÃ­o.</p>";
        } else {
            let html = "<h2>Resumen del carrito:</h2><ul>";
            let total = 0;
    
            carrito.forEach(producto => {
                html += `<li>${producto.nombre} - ${producto.precio.toFixed(2)} â‚¬</li>`;
                total += producto.precio;
            });
    
            html += `</ul><p><strong>Total: ${total.toFixed(2)} â‚¬</strong></p>`;
            contenedor.innerHTML = html;
        }
    </script>
    
</body>
</html>
